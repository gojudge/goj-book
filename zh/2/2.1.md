## 2.1 概述

判题服务器由go语言实现，在服务逻辑主循环中另起一个线程执行TCP监听，主线程中执行HTTP监听，监听收到信息后会自动进行初步解析，得到客户端请求中的action名称，然后由router模块解析调用对应的controller，其中router模块是一个map结构，调用对应的controller后执行不同的业务逻辑，对于TCP，客户端连接后首先应该做的是登录操作，由LoginController执行登录验证并给客户端返回一个session id以记录当前连接的会话。之后客户端可以发送添加判题任务的请求，服务端收到请求后便会执行判题任务，并将判题数据和结果收集保存于sqlite数据库并发送至客户端。对于HTTP连接，由于是基于JSON-RPC协议的，因此每一个请求都将验证密码，但是密码验证是处于controller的base struct(相当于java中的基类)中，因此无需在每一个业务逻辑中手动进行验证。至於业务逻辑的处理与TCP方式的controller是一样的。


